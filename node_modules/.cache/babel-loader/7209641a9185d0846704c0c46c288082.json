{"ast":null,"code":"import { politicsReducer } from \"./politics-reducer\";\nimport CountiesState from \"./counties-state\";\nimport regionsStore from \"./store-regions/regions-store\";\n\nfunction rerender() {}\n\nlet store = {\n  _state: CountiesState.sikvoa_comunism,\n\n  dispatch(action) {\n    politicsReducer(this, action);\n    rerender();\n  },\n\n  updateFactory() {\n    regionsStore.getValue(this._state.tag, \"factoryValue\");\n  },\n\n  updateIdeas() {\n    let index = 0;\n\n    for (let idea of this._state.ideas) {\n      if (!idea.conditionAwaible(store)) {\n        this._state.ideas.splice(index, 1);\n      }\n\n      index++;\n    }\n  },\n\n  updateCurrentFlag() {\n    this._state.currentFlag = this._state.flags[this._state.rulingParty];\n  },\n\n  normalizeIdeologues() {\n    let summIdeology = 0;\n\n    for (let ideology in this._state.ideologues) {\n      let ideologyValue = this._state.ideologues[ideology];\n      summIdeology += ideologyValue;\n    }\n\n    for (let ideology in this._state.ideologues) {\n      this._state.ideologues[ideology] /= summIdeology;\n      this._state.ideologues[ideology] *= 100;\n    }\n  },\n\n  update() {\n    this._state.ideologuesDrift = {\n      communism: 0,\n      monarchy: 0,\n      imperialism: 0,\n      democracy: 0\n    };\n\n    for (let commander of this._state.commanders) {\n      commander.influence(this);\n    }\n\n    for (let idea of this._state.ideas) {\n      idea.influences(this);\n    }\n\n    for (let ideology in this._state.ideologuesDrift) {\n      this._state.ideologues[ideology] += this._state.ideologuesDrift[ideology];\n\n      if (this._state.ideologues[ideology] < 0) {\n        this._state.ideologues[ideology] = 0.01;\n      }\n    }\n\n    this.updateFactory();\n    this.updateIdeas();\n    this.updateRulingParty();\n    this.updateCurrentFlag();\n    this.normalizeIdeologues();\n    console.log(this._state.factoriesValue);\n  },\n\n  updateRulingParty() {\n    for (let ideology in this._state.ideologues) {\n      let ideologyPopularity = this._state.ideologues[ideology];\n\n      if (ideologyPopularity > 50) {\n        this._state.rulingParty = ideology;\n      }\n    }\n  },\n\n  setDrift(ideology, driftValue, user) {\n    user.clearOptions();\n    this._state.ideologuesDrift[ideology] += driftValue;\n    user.addOptions(`Поддержка идеологии ${ideology} +${driftValue}`);\n  },\n\n  setUpdate(callback) {\n    rerender = callback;\n  },\n\n  generateIdeologuesData() {\n    let data = [];\n\n    for (let ideology in this._state.ideologues) {\n      let population = this._state.ideologues[ideology];\n      let dataObject = [ideology, population];\n      data.push(dataObject);\n    }\n\n    return data;\n  },\n\n  get rulingParty() {\n    return this._state.rulingParty;\n  },\n\n  get commanders() {\n    return this._state.commanders;\n  },\n\n  get ideas() {\n    return this._state.ideas;\n  },\n\n  get flag() {\n    return `images/flags/${this._state.currentFlag}`;\n  },\n\n  get ideologuesColor() {\n    return this._state.ideologuesColors;\n  }\n\n};\nstore.update();\nexport default store;","map":{"version":3,"sources":["C:/Users/Glib/Desktop/projects/minecraft-countries/src/store/store.js"],"names":["politicsReducer","CountiesState","regionsStore","rerender","store","_state","sikvoa_comunism","dispatch","action","updateFactory","getValue","tag","updateIdeas","index","idea","ideas","conditionAwaible","splice","updateCurrentFlag","currentFlag","flags","rulingParty","normalizeIdeologues","summIdeology","ideology","ideologues","ideologyValue","update","ideologuesDrift","communism","monarchy","imperialism","democracy","commander","commanders","influence","influences","updateRulingParty","console","log","factoriesValue","ideologyPopularity","setDrift","driftValue","user","clearOptions","addOptions","setUpdate","callback","generateIdeologuesData","data","population","dataObject","push","flag","ideologuesColor","ideologuesColors"],"mappings":"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","sourcesContent":["import {politicsReducer} from \"./politics-reducer\";\r\nimport CountiesState from \"./counties-state\";\r\nimport regionsStore from \"./store-regions/regions-store\";\r\n\r\nfunction rerender(){\r\n\r\n}\r\n\r\nlet store = {\r\n    _state : CountiesState.sikvoa_comunism,\r\n    dispatch(action){\r\n        politicsReducer(this, action);\r\n        rerender();\r\n    },\r\n    updateFactory(){\r\n        regionsStore.getValue(this._state.tag, \"factoryValue\");\r\n    },\r\n    updateIdeas(){\r\n        let index = 0;\r\n        for (let idea of this._state.ideas){\r\n            if (!idea.conditionAwaible(store)){\r\n                this._state.ideas.splice(index, 1);\r\n            }\r\n            index ++\r\n        }\r\n    },\r\n    updateCurrentFlag(){\r\n        this._state.currentFlag = this._state.flags[this._state.rulingParty];\r\n    },\r\n    normalizeIdeologues(){\r\n        let summIdeology = 0;\r\n      for (let ideology in this._state.ideologues){\r\n          let ideologyValue = this._state.ideologues[ideology];\r\n          summIdeology += ideologyValue;\r\n      }\r\n      for (let ideology in this._state.ideologues){\r\n          this._state.ideologues[ideology] /= summIdeology;\r\n          this._state.ideologues[ideology] *= 100;\r\n      }\r\n    },\r\n    update(){\r\n        this._state.ideologuesDrift = {\r\n            communism : 0,\r\n            monarchy : 0,\r\n            imperialism : 0,\r\n            democracy : 0,\r\n        };\r\n        for (let commander of this._state.commanders){\r\n            commander.influence(this);\r\n        }\r\n        for (let idea of this._state.ideas){\r\n            idea.influences(this);\r\n        }\r\n        for (let ideology in this._state.ideologuesDrift){\r\n            this._state.ideologues[ideology] += this._state.ideologuesDrift[ideology];\r\n            if (this._state.ideologues[ideology] < 0){\r\n                this._state.ideologues[ideology] = 0.01;\r\n            }\r\n        }\r\n        this.updateFactory();\r\n        this.updateIdeas();\r\n        this.updateRulingParty();\r\n        this.updateCurrentFlag();\r\n        this.normalizeIdeologues();\r\n        console.log(this._state.factoriesValue);\r\n    },\r\n    updateRulingParty(){\r\n        for (let ideology in this._state.ideologues){\r\n            let ideologyPopularity = this._state.ideologues[ideology];\r\n            if (ideologyPopularity > 50){\r\n                this._state.rulingParty = ideology;\r\n            }\r\n        }\r\n    },\r\n    setDrift(ideology, driftValue, user){\r\n        user.clearOptions();\r\n        this._state.ideologuesDrift[ideology] += driftValue;\r\n        user.addOptions(`Поддержка идеологии ${ideology} +${driftValue}`);\r\n\r\n    },\r\n    setUpdate(callback){\r\n        rerender = callback;\r\n    },\r\n    generateIdeologuesData(){\r\n        let data = [];\r\n\r\n        for (let ideology in this._state.ideologues){\r\n\r\n            let population = this._state.ideologues[ideology];\r\n            let dataObject = [ideology, population];\r\n            data.push(dataObject)\r\n        }\r\n        return data;\r\n    },\r\n    get rulingParty(){\r\n        return this._state.rulingParty;\r\n    },\r\n    get commanders(){\r\n        return this._state.commanders;\r\n    },\r\n    get ideas(){\r\n        return this._state.ideas;\r\n    },\r\n    get flag(){\r\n        return `images/flags/${this._state.currentFlag}`;\r\n    },\r\n    get ideologuesColor(){\r\n        return this._state.ideologuesColors;\r\n    },\r\n\r\n}\r\nstore.update();\r\nexport default store;"]},"metadata":{},"sourceType":"module"}